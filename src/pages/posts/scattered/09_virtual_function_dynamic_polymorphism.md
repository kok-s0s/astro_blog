---
title: '虚函数实现动态多态的原理'
---

在C++中，虚函数用于实现**动态多态**，其原理是通过**虚函数表**（vtable）和**虚指针**（vptr）实现的。

- **虚函数表（vtable）**：这是一个函数指针数组，用于存储类中的虚函数的地址。每个类都有自己的虚函数表，当派生类覆盖了基类中的虚函数时，虚函数表中的对应条目会指向派生类的实现。

- **虚指针（vptr）**：在每个包含虚函数的对象中，编译器会隐式插入一个指向虚函数表的指针，这个指针称为虚指针（vptr）。当调用虚函数时，程序会通过这个虚指针找到对应的虚函数表，然后根据虚函数表中的函数指针调用正确的函数实现。

**动态多态**的实现关键在于，当通过基类指针或引用调用虚函数时，程序在运行时会根据实际对象类型（派生类或基类）来决定调用哪个函数，而不是在编译时确定。这种机制使得程序可以在运行时灵活地调用合适的函数，支持多态性。
